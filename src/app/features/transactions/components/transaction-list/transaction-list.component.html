<!-- The wrapper div now has a permanent grid layout class -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  
  <!-- The loop and card structure remain the same -->
  @for (transaction of transactions; track transaction.id) {
    <mat-card class="flex items-center p-3 border rounded-lg shadow-sm">
      <div class="flex-shrink-0 mr-4">
        <mat-icon [style.color]="getCategory(transaction.categoryId)?.color || '#3F51B5'">
          {{ getCategory(transaction.categoryId)?.icon || 'category' }}
        </mat-icon>
      </div>
      <div class="flex-grow">
        <p class="font-bold text-gray-800">{{ getCategory(transaction.categoryId)?.name || 'Uncategorized' }}</p>
        <p class="text-sm text-gray-500">{{ transaction.description || 'No description' }}</p>
      </div>
      <div class="text-right flex-shrink-0 ml-4">
        <p class="font-bold text-lg" [ngClass]="{
          'text-green-600': transaction.type === 'income',
          'text-red-600': transaction.type === 'expense'
        }">
          @if (transaction.type === 'income') {
            <span>+</span>
          }
          @if (transaction.type === 'expense') {
            <span>-</span>
          }
          {{ transaction.amount | takaCurrency }}
        </p>
        <p class="text-sm text-gray-500">{{ transaction.date | date:'dd MMM yyyy' }}</p>
      </div>
      <div>
        <button mat-icon-button [matMenuTriggerFor]="menu">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="onEdit(transaction)">
            <mat-icon>edit</mat-icon>
            <span>Edit</span>
          </button>
          <button mat-menu-item (click)="onDelete(transaction.id)">
            <mat-icon color="warn">delete</mat-icon>
            <span class="text-warn">Delete</span>
          </button>
        </mat-menu>
      </div>
    </mat-card>
  } @empty {
    <!-- The empty state message now needs to span all columns of the grid -->
    <mat-card class="text-center p-8 border rounded-lg col-span-full">
      <p class="text-gray-500">No transactions match the current filters.</p>
    </mat-card>
  }
</div>